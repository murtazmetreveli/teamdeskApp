"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5279],{5279:(S,N,s)=>{s.r(N),s.d(N,{NotificationsModule:()=>E});var h=s(177),C=s(6565),p=s(467),b=s(617),v=s(6598),t=s(6276),F=s(310),u=s(5933),_=s(4503);function R(i,r){if(1&i&&(t.qex(0),t.j41(1,"ion-col",8)(2,"ion-text"),t.EFF(3),t.k0s()(),t.j41(4,"ion-col",9)(5,"span",10),t.EFF(6),t.nI1(7,"date"),t.k0s()(),t.bVm()),2&i){const n=r.$implicit;t.R7$(3),t.JRh(null==n?null:n.message),t.R7$(3),t.JRh(t.i5U(7,2,null==n?null:n.created_at,"HH:mm"))}}function w(i,r){if(1&i&&(t.j41(0,"ion-row",4)(1,"ion-col",5)(2,"span",6),t.EFF(3),t.k0s()(),t.DNE(4,R,8,5,"ng-container",7),t.k0s()),2&i){const n=r.$implicit,o=t.XpG();t.R7$(3),t.SpI(" ",n.key," "),t.R7$(1),t.Y8G("ngForOf",o.isArray(null==n?null:n.value))}}function M(i,r){if(1&i&&(t.qex(0),t.j41(1,"ion-col",8)(2,"ion-text"),t.EFF(3),t.k0s()(),t.j41(4,"ion-col",9)(5,"span",10),t.EFF(6),t.nI1(7,"date"),t.k0s()(),t.bVm()),2&i){const n=r.$implicit;t.R7$(3),t.JRh(null==n?null:n.message),t.R7$(3),t.JRh(t.i5U(7,2,null==n?null:n.created_at,"HH:mm"))}}function x(i,r){if(1&i&&(t.j41(0,"ion-row",4)(1,"ion-col",5)(2,"span",6),t.EFF(3),t.k0s()(),t.DNE(4,M,8,5,"ng-container",7),t.k0s()),2&i){const n=r.$implicit,o=t.XpG();t.R7$(3),t.SpI(" ",n.key," "),t.R7$(1),t.Y8G("ngForOf",o.isArray(null==n?null:n.value))}}function D(i,r){if(1&i&&(t.qex(0),t.j41(1,"ion-col",8)(2,"ion-text"),t.EFF(3),t.k0s()(),t.j41(4,"ion-col",9)(5,"span",10),t.EFF(6),t.nI1(7,"date"),t.k0s()(),t.bVm()),2&i){const n=r.$implicit;t.R7$(3),t.JRh(null==n?null:n.message),t.R7$(3),t.JRh(t.i5U(7,2,null==n?null:n.created_at,"HH:mm"))}}function $(i,r){if(1&i&&(t.j41(0,"ion-row",4)(1,"ion-col",5)(2,"span",6),t.EFF(3),t.k0s()(),t.DNE(4,D,8,5,"ng-container",7),t.k0s()),2&i){const n=r.$implicit,o=t.XpG();t.R7$(3),t.SpI(" ",n.key," "),t.R7$(1),t.Y8G("ngForOf",o.isArray(null==n?null:n.value))}}const P=[{path:"",component:(()=>{class i{constructor(n,o,a){var O=this;this.api=n,this.loadingController=o,this.ref=a,this.headerData={title:"Notifications",button_text:"Route Complete",serach:!1},this.swiperModules=[b.Jl],this.todayNotification={},this.yesterdayNotification={},this.notification=[],this.arrayReverseObj=f=>{let c=[];return Object.keys(f).reverse().forEach(m=>{c.push({key:m,value:f[m]})}),c},this.dataScanSubscription=this.api.notificationRedirect.subscribe(function(){var f=(0,p.A)(function*(c){c&&(yield O.getNotificationData(),O.ref.detectChanges())});return function(c){return f.apply(this,arguments)}}())}ngOnInit(){}ionViewWillLeave(){this.todayNotification={},this.yesterdayNotification={},this.notification=[],this.dataScanSubscription&&this.dataScanSubscription.unsubscribe()}ngOnDestroy(){this.todayNotification={},this.yesterdayNotification={},this.notification=[],this.dataScanSubscription&&this.dataScanSubscription.unsubscribe()}ionViewWillEnter(){var n=this;return(0,p.A)(function*(){yield n.getNotificationData()})()}getNotificationData(){var n=this;return(0,p.A)(function*(){const o=yield n.loadingController.create({cssClass:"spinner",mode:"md"});yield o.present();try{n.todayNotification={},n.yesterdayNotification={},n.notification=[],(yield v.l.getStatus()).connected?n.api.showNotification().subscribe(function(){var f=(0,p.A)(function*(c){c&&(yield o.dismiss());const m=new Date;m.setHours(0,0,0,0);const y=new Date;y.setDate(y.getDate()-1),y.setHours(0,0,0,0);const g={};c.forEach(l=>{const d=new Date(l.created_at);let e;d.setHours(0,0,0,0),d.getTime()===m.getTime()?(e="Today",n.todayNotification[e]||(n.todayNotification[e]=[]),n.todayNotification[e].push(l)):d.getTime()===y.getTime()?(e="Yesterday",n.yesterdayNotification[e]||(n.yesterdayNotification[e]=[]),n.yesterdayNotification[e].push(l)):(e=d.toLocaleString("en-US",{day:"numeric",month:"long",year:"numeric"}),g[e]||(g[e]=[]),g[e].push(l))});const A=Object.keys(g).sort((l,d)=>{const e=new Date(l);return new Date(d).getTime()-e.getTime()});n.notification=A.map(l=>({key:l,value:g[l]}))});return function(c){return f.apply(this,arguments)}}(),function(){var f=(0,p.A)(function*(c){yield o.dismiss()});return function(c){return f.apply(this,arguments)}}()):yield o.dismiss()}catch(a){yield o.dismiss(),console.error("Error fetching notifications:",a)}})()}isArray(n){return Array.isArray(n)?(n.length&&n[0].hasOwnProperty("created_at")&&n.sort((o,a)=>new Date(a.created_at).getTime()-new Date(o.created_at).getTime()),n):n instanceof Map?(Array.from(n.values()).length&&Array.from(n.values())[0].hasOwnProperty("created_at")&&Array.from(n.values()).sort((o,a)=>new Date(a.created_at).getTime()-new Date(o.created_at).getTime()),Array.from(n.values())):[]}objValue(n){return Object.values(n)}static{this.\u0275fac=function(o){return new(o||i)(t.rXU(F.G),t.rXU(u.Xi),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-notifications"]],decls:8,vars:9,consts:[[1,"ion-no-border"],[3,"headerObj"],[1,"ion-padding","notification",3,"fullscreen"],["class","message",4,"ngFor","ngForOf"],[1,"message"],["size","12"],[1,"day"],[4,"ngFor","ngForOf"],["size","10",1,"message-text","mtb-27"],["size","2",1,"ion-flex","mtb-27","ion-align-self-center"],[1,"time"]],template:function(o,a){1&o&&(t.j41(0,"ion-header",0),t.nrm(1,"app-sub-header",1),t.k0s(),t.j41(2,"ion-content",2),t.DNE(3,w,5,2,"ion-row",3),t.nI1(4,"keyvalue"),t.DNE(5,x,5,2,"ion-row",3),t.nI1(6,"keyvalue"),t.DNE(7,$,5,2,"ion-row",3),t.k0s()),2&o&&(t.R7$(1),t.Y8G("headerObj",a.headerData),t.R7$(1),t.Y8G("fullscreen",!1),t.R7$(1),t.Y8G("ngForOf",t.bMT(4,5,a.todayNotification)),t.R7$(2),t.Y8G("ngForOf",t.bMT(6,7,a.yesterdayNotification)),t.R7$(2),t.Y8G("ngForOf",a.notification))},dependencies:[h.Sq,_.R,u.hU,u.W9,u.eU,u.ln,u.IO,h.vh,h.lG],styles:[".notification[_ngcontent-%COMP%]{margin-top:13pt;display:flex;align-items:center;justify-content:space-between}.notification[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-text-green);font-size:10pt;font-weight:700}.notification[_ngcontent-%COMP%]   .day[_ngcontent-%COMP%]{padding-top:10pt}.notification[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]{background:var(--ion-color-light-contrast-rgb);border-radius:10px;padding:10px}.notification[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:13pt;color:var(--ion-text-color)}.notification[_ngcontent-%COMP%]   .message-text[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:20px;width:20px;position:absolute;left:-1px;bottom:-10px}.notification[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{margin-left:10px}.notification[_ngcontent-%COMP%]   .mtb-27[_ngcontent-%COMP%]{margin-top:12pt;margin-bottom:27pt}.notification[_ngcontent-%COMP%]   swiper-slide[_ngcontent-%COMP%]{color:#000}"]})}}return i})()}];let T=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[C.iI.forChild(P),C.iI]})}}return i})();var j=s(1542);let E=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[h.MD,T,j.c,u.bv]})}}return i})()}}]);